<app-header></app-header>
<app-body *ngIf="env$ | async as env">
    <app-main-menu *ngIf="env?.FLAVOR !== 'ont'"></app-main-menu>
    <app-main-content *transloco="let t">
        <div class="app-main">
            <ul class="app-breadcrumbs">
                <li
                    *ngFor="let bc of breadCrumbsNames; let i = index"
                    class="app-breadcrumbs__item"
                    [class.active]="i == activeBreadCrumbIndex"
                >
                    <a>{{ i + 1 }}. {{ t(bc) }}</a>
                </li>
            </ul>
            <div style="clear: both; margin-bottom: 20px"></div>
            <app-certified-info
                *ngIf="activeBreadCrumbIndex == breadCrumbs.INFO"
            ></app-certified-info>
            <app-certified-data-form
                (formChange)="onDataFormChange($event)"
                *ngIf="activeBreadCrumbIndex == breadCrumbs.DATA"
            ></app-certified-data-form>
            <app-certified-env-form
                (formChange)="onEnvFormChange($event)"
                *ngIf="activeBreadCrumbIndex == breadCrumbs.ENVIRONMENT"
            ></app-certified-env-form>
            <button
                *ngIf="
                    !isReady && activeBreadCrumbIndex < breadCrumbs.ENVIRONMENT
                "
                mat-flat-button
                color="primary"
                style="margin-top: 1.6em"
                (click)="nextBreadCrumb()"
                [disabled]="
                    activeBreadCrumbIndex > breadCrumbs.INFO && !isDataFormValid
                "
            >
                {{ t("Next") }}
            </button>
            <button
                *ngIf="
                    isReady || activeBreadCrumbIndex == breadCrumbs.ENVIRONMENT
                "
                mat-flat-button
                color="primary"
                style="margin-top: 1.6em"
                (click)="startCertifiedMeasurement()"
                [disabled]="
                    activeBreadCrumbIndex == breadCrumbs.ENVIRONMENT
                        ? !isEnvFormValid
                        : !isDataFormValid
                "
            >
                {{ t("Start certified measurement") }}
            </button>
        </div>
    </app-main-content>
</app-body>
